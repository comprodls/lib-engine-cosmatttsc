"use strict";!function(e){e.fn.TSCurve=function(a){var t,o=e(this),i={showApplicationPoints:!1,motorSelectedIndex:3,rmsPoints:[190,44],peakPoints:[400,60],quadrant:1,sliderLimit:{peakMaxSpeed:800,peakMaxTorque:100,rmsMaxSpeed:800,rmsMaxTorque:100,maxTemp:125,maxAltitude:1e4,maxVoltage:10,maxTrRatio:100},showQuadrantToggle:!0,showMotorTsCurve:!0,showMotorSelForm:!0,showAppPointsForm:!0,showEnviorForm:!0,showTransmissionForm:!0,uniqeId:"1"},d=e.extend({},i,a),l=function(){var a=e('<div class="tsCruveContainer row m-0"></div>');o.append(a),r(a)},r=function(a){var t=e('<div id="servoMotorTSCurve"></div>');if(a.append(t),d.showMotorSelForm||d.showAppPointsForm||d.showEnviorForm||d.showTransmissionForm){t.addClass("col-md-7");var o=e('<div class="col-md-5 row" id="servoMotorArea"></div>');a.append(o),n(o)}else t.addClass("col-md-12 widthMaxLimit");q(t),k()},n=function(a){var t=e('<div id="motorAreaAccordionContainer"></div>');a.append(t);var o=e('<div class="panel-group" id="accordion'+d.uniqeId+'" role="tablist" aria-multiselectable="true"></div>');t.append(o),d.showMotorTsCurve||(d.showMotorSelForm=!1),d.showMotorSelForm&&s(o),d.showApplicationPoints||(d.showAppPointsForm=!1),d.showAppPointsForm&&c(o),d.showEnviorForm&&S(o),d.showTransmissionForm&&T(o),p()},s=function(a){var t=e('<div class="panelNew panel-defaultNew"></div>');a.append(t);var o=e('<div class="panel-heading panelHeadingNew" role="tab" id="headingOne"> <h4 class="panel-title"> <span id="panelHeading"> Solution Selection</span> <span class="accordion-plus-minus  pull-right" aria-hidden="true" style="color: grey;"></span></h4> </div>');t.append(o);var i=e('<div id="collapseOne" class="panel-collapse collapse motorDataOpenPanle" role="tabpanel" aria-labelledby="headingOne"></div>');t.append(i);var d=e('<div class="panel-body"></div>');i.append(d),t.on("show.bs.collapse",function(a){e(this).find(".accordion-plus-minus").removeClass("glyphicon-chevron-down fa fa-chevron-down").addClass("glyphicon-chevron-up fa fa-chevron-up")}),t.on("hide.bs.collapse",function(a){e(this).find(".accordion-plus-minus").removeClass("glyphicon-chevron-up fa fa-chevron-up").addClass("glyphicon-chevron-down fa fa-chevron-down")}),u(t)},u=function(a){for(var t=d.motorData.length,i=[],l=0;t>l;l++)i.push(l);var r=a.find("#collapseOne .panel-body"),n=e('<div id="motorDataContainer" class="row"></div>');r.append(n);var s=e('<div class="col-sm-3 title"><span id="solutionTitle">Solution Size: </sapn></div>');n.append(s);var u=e('<div class="col-sm-9"><input width="300" id="solutionSliderId" class="span2" type="text" data-slider-id="sizeSlider" data-slider-ticks="['+i+']" data-slider-min="0" data-slider-max="'+t+'" data-slider-step="1" data-slider-value="'+d.motorSelectedIndex+'" data-slider-tooltip="hide"  /></div>');n.append(u);var c=e('<div class="col-sm-11 solutionDivider"></div>');n.append(c);var m=e('<div class="col-sm-12 solutionInfoTitle">Solution Summary</div>');n.append(m);var v=e('<div class="col-sm-12 solutionInfoContainer row"></div>');n.append(v);var f=e('<div class="col-sm-6"><span class="driveTitle">Drive:</span><span class="driveName" id="driveNameId">'+d.motorData[d.motorSelectedIndex].drivePartNo+"</span></div>");v.append(f);var S=e('<div class="col-sm-6"><span class="motorTitle">Motor:</span><span class="motorName" id="motorNameId">'+d.motorData[d.motorSelectedIndex].motorPartNo+"</span></div>");v.append(S);var h=e('<div class="col-sm-12 solutionInfoContainer row"></div>');n.append(h);var T=e('<div class="col-sm-6"><span class="voltageTitle">Voltage:</span><span class="voltageName" id="voltageInfoId">'+d.motorData[d.motorSelectedIndex].voltage+" V</span></div>");h.append(T);var x=e('<div class="col-sm-6"><span class="solutionStatusTitle">Solution Status:</span><span class="solutionStatus motorPass" id="statusValueContainer">Pass</span></div>');h.append(x);u.find("#solutionSliderId").slider({}).on("change",function(e){console.log(d.motorData[e.value.newValue].drivePartNo),n.find("#driveNameId").text(d.motorData[e.value.newValue].drivePartNo),n.find("#motorNameId").text(d.motorData[e.value.newValue].motorPartNo),n.find("#voltageInfoId").text(d.motorData[e.value.newValue].voltage+" V"),d.motorSelectedIndex=e.value.newValue,o.find("#tempSlider").slider("setValue",d.motorData[d.motorSelectedIndex].temp),o.find("#tempValue").val(d.motorData[d.motorSelectedIndex].temp),o.find("#altitudeSlider").slider("setValue",d.motorData[d.motorSelectedIndex].altitude),o.find("#altitudeValue").val(d.motorData[d.motorSelectedIndex].altitude),d.defaultPeakStallTorque=d.motorData[d.motorSelectedIndex].peakStallTorque,d.defaultRollOffPoint=d.motorData[d.motorSelectedIndex].rollOffPoint,d.defaultRollOffSpeed=d.motorData[d.motorSelectedIndex].rollOffSpeed,d.defaultPeakTorqueAtMaxSpeed=d.motorData[d.motorSelectedIndex].peakTorqueAtMaxSpeed,d.defaultContinuousStallTorque=d.motorData[d.motorSelectedIndex].continuousStallTorque,d.defaultContinuosTorqueAtMaxSpeed=d.motorData[d.motorSelectedIndex].continuosTorqueAtMaxSpeed,d.motorSelectedIndex=e.value.newValue,P(),p()})},p=function(){var e=C(d.motorData[d.motorSelectedIndex]).status;if(d.showMotorSelForm){var a=o.find("#statusValueContainer");a.removeClass("motorPass"),a.removeClass("motorFail"),a.addClass(e?"motorPass":"motorFail"),a.text(e?"Pass":"Fail")}if(d.showAppPointsForm){var t=o.find("#servoMotorArea #tsPointsPanelContainer #statusValueContainer");t.find(".motorStatusIcon").removeClass("glyphicon-remove").removeClass("glyphicon-ok").addClass(e?"glyphicon-ok":"glyphicon-remove"),t.find("#statusValueLabel").text(e?"Motor Pass":"Motor Fail")}},c=function(a){var t=e('<div class="panel panel-default"></div>');a.append(t);var o=e('<div class="panel-heading" role="tab" id="headingTwo"> <h4 class="panel-title"> <a role="button" data-parent="#accordion'+d.uniqeId+'" data-toggle="collapse"  href="#collapseTwo'+d.uniqeId+'" aria-controls="collapseTwo" aria-expanded="false"><span>Application Torque Speed Requirements </span><span class="accordion-plus-minus glyphicon pull-right glyphicon-chevron-down fa fa-chevron-down" aria-hidden="true" style="color: grey;"></span> </a> </h4> </div>');t.append(o);var i=e('<div id="collapseTwo'+d.uniqeId+'" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo"></div>');t.append(i),t.on("show.bs.collapse",function(a){e(this).find(".accordion-plus-minus").removeClass("glyphicon-chevron-down fa fa-chevron-down").addClass("glyphicon-chevron-up fa fa-chevron-up")}),t.on("hide.bs.collapse",function(a){e(this).find(".accordion-plus-minus").removeClass("glyphicon-chevron-up fa fa-chevron-up").addClass("glyphicon-chevron-down fa fa-chevron-down")}),d.showMotorSelForm||i.addClass("in"),f(i)},m=function(e,a){var i=t.getData();switch(e){case"PeakSpeed":i[1].data[0][0]=d.peakPoints[0]=a,d.defaultPeakSpeed=a,o.find("#peakSpeedSlider").slider("setValue",a);break;case"PeakTorque":i[1].data[0][1]=d.peakPoints[1]=a,d.defaultPeakTorque=a,o.find("#peakTorqueSlider").slider("setValue",a);break;case"RmsSpeed":i[3].data[0][0]=d.rmsPoints[0]=a,d.defaultRmsSpeed=a,o.find("#rmsSpeedSlider").slider("setValue",a);break;case"RmsTorque":i[3].data[0][1]=d.rmsPoints[1]=a,d.defaultRmsTorque=a,o.find("#rmsTorqueSlider").slider("setValue",a);break;case"TransmissionRatio":var l=a,i=t.getData();i[1].data[0][0]=d.peakPoints[0]=(d.defaultPeakSpeed*l).toFixed(2),i[1].data[0][1]=d.peakPoints[1]=(d.defaultPeakTorque/l).toFixed(2),i[3].data[0][0]=d.rmsPoints[0]=(d.defaultRmsSpeed*l).toFixed(2),i[3].data[0][1]=d.rmsPoints[1]=(d.defaultRmsTorque/l).toFixed(2),i[1].data[0][0]>d.sliderLimit.peakMaxSpeed?o.find("#peakSpeedValue").attr("max",parseInt(i[1].data[0][0])):o.find("#peakSpeedValue").attr("max",d.sliderLimit.peakMaxSpeed),i[3].data[0][0]>d.sliderLimit.rmsMaxSpeed?o.find("#rmsSpeedValue").attr("max",parseInt(i[3].data[0][0])):o.find("#rmsSpeedValue").attr("max",d.sliderLimit.rmsMaxSpeed),o.find("#trRatioSlider").slider("setValue",a),o.find("#peakSpeedSlider").slider("setValue",i[1].data[0][0]),o.find("#peakTorqueSlider").slider("setValue",i[1].data[0][1]),o.find("#rmsSpeedSlider").slider("setValue",i[3].data[0][0]),o.find("#rmsTorqueSlider").slider("setValue",i[3].data[0][1]),o.find("#peakSpeedValue").val(i[1].data[0][0]),o.find("#peakTorqueValue").val(i[1].data[0][1]),o.find("#rmsSpeedValue").val(i[3].data[0][0]),o.find("#rmsTorqueValue").val(i[3].data[0][1])}y(i),p()},v=function(a){var i=t.getData();switch(a){case"PeakSpeed":i[1].data[0][0]=d.peakPoints[0]=o.find("#peakSpeedSlider").slider("getValue"),d.defaultPeakSpeed=o.find("#peakSpeedSlider").slider("getValue"),o.find("#peakSpeedValue").val(e("#peakSpeedSlider").slider("getValue"));break;case"PeakTorque":i[1].data[0][1]=d.peakPoints[1]=o.find("#peakTorqueSlider").slider("getValue"),d.defaultPeakTorque=o.find("#peakTorqueSlider").slider("getValue"),o.find("#peakTorqueValue").val(e("#peakTorqueSlider").slider("getValue"));break;case"RmsSpeed":i[3].data[0][0]=d.rmsPoints[0]=o.find("#rmsSpeedSlider").slider("getValue"),d.defaultRmsSpeed=o.find("#rmsSpeedSlider").slider("getValue"),o.find("#rmsSpeedValue").val(e("#rmsSpeedSlider").slider("getValue"));break;case"RmsTorque":i[3].data[0][1]=d.rmsPoints[1]=o.find("#rmsTorqueSlider").slider("getValue"),d.defaultRmsTorque=o.find("#rmsTorqueSlider").slider("getValue"),o.find("#rmsTorqueValue").val(e("#rmsTorqueSlider").slider("getValue"));break;case"TransmissionRatio":var l=o.find("#trRatioSlider").slider("getValue"),i=t.getData();i[1].data[0][0]=d.peakPoints[0]=(d.defaultPeakSpeed*l).toFixed(2),i[1].data[0][1]=d.peakPoints[1]=(d.defaultPeakTorque/l).toFixed(2),i[3].data[0][0]=d.rmsPoints[0]=(d.defaultRmsSpeed*l).toFixed(2),i[3].data[0][1]=d.rmsPoints[1]=(d.defaultRmsTorque/l).toFixed(2),i[1].data[0][0]>d.sliderLimit.peakMaxSpeed?o.find("#peakSpeedSlider").slider("setAttribute","max",parseInt(i[1].data[0][0])):o.find("#peakSpeedSlider").slider("setAttribute","max",d.sliderLimit.peakMaxSpeed),i[3].data[0][0]>d.sliderLimit.rmsMaxSpeed?o.find("#rmsSpeedSlider").slider("setAttribute","max",parseInt(i[3].data[0][0])):o.find("#rmsSpeedSlider").slider("setAttribute","max",d.sliderLimit.rmsMaxSpeed),o.find("#peakSpeedSlider").slider("setValue",i[1].data[0][0]),o.find("#peakTorqueSlider").slider("setValue",i[1].data[0][1]),o.find("#rmsSpeedSlider").slider("setValue",i[3].data[0][0]),o.find("#rmsTorqueSlider").slider("setValue",i[3].data[0][1]),o.find("#trRatioValue").val(l),o.find("#peakSpeedValue").val(i[1].data[0][0]),o.find("#peakTorqueValue").val(i[1].data[0][1]),o.find("#rmsSpeedValue").val(i[3].data[0][0]),o.find("#rmsTorqueValue").val(i[3].data[0][1])}y(i),p()},f=function(a){var t=e('<div class="panel-body"></div>');a.append(t);var i=e('<div id="tsPointsPanelContainer"></div>');t.append(i);var l=e('<div id="sliderContainer" class="row"></div>');i.append(l);var r=e('<div class="col-sm-3 title"><span id="peakTorqueTitle">Peak Torque: </span></div>');l.append(r);var n=e('<div class="col-sm-4"><input id="peakTorqueSlider" data-slider-value="'+d.peakPoints[1]+'" data-slider-id="sizeSlider" type="text" data-slider-tooltip="hide"/></div>');l.append(n);var s=e('<div class="col-sm-5"><input type="number" name="quantity" id="peakTorqueValue" min="0" max="'+d.sliderLimit.peakMaxTorque+'" value="'+d.peakPoints[1]+'" class="widgetNumberInput form-control bfh-number"><lable class="value">&nbsp;&nbsp;Nm</label></div>');l.append(s);var u=(n.find("#peakTorqueSlider").slider({min:0,max:d.sliderLimit.peakMaxTorque,step:.1}).on("change",function(){return n.find("#peakTorqueSlider").slider("getValue")<d.rmsPoints[1]?(n.find("#peakTorqueSlider").slider("setValue",u),V("Peak Torque can not be less than RMS Torque."),!1):(V(""),v("PeakTorque"),void(u=n.find("#peakTorqueSlider").slider("getValue")))}),n.find("#peakTorqueSlider").slider("getValue"));o.find("#peakTorqueValue").on("change",function(e){m("PeakTorque",e.target.value)});var p=e('<div id="sliderContainer" class="row"></div>');i.append(p);var c=e('<div class="col-sm-3 title"><span id="peakSpeedTitle">Peak Speed: </sapn></div>');p.append(c);var f=e('<div class="col-sm-4"><input id="peakSpeedSlider" data-slider-value="'+d.peakPoints[0]+'" data-slider-id="sizeSlider" type="text" data-slider-tooltip="hide"/></div>');p.append(f);var S=e('<div class="col-sm-5"><input step="1"  data-wrap="true" type="number" id="peakSpeedValue" name="quantity" min="0" max="'+d.sliderLimit.peakMaxSpeed+'" value="'+d.peakPoints[0]+'" class="widgetNumberInput form-control bfh-number form-control bfh-number"><lable class="value">&nbsp;&nbsp;rad/sec</label></div>');p.append(S);f.find("#peakSpeedSlider").slider({min:0,max:d.sliderLimit.peakMaxSpeed,step:1}).on("change",function(){return f.find("#peakSpeedSlider").slider("getValue")<d.rmsPoints[0]?(f.find("#peakSpeedSlider").slider("setValue",d.rmsPoints[0]),V("Peak Speed can not be less than RMS Speed."),!1):(V(""),void v("PeakSpeed"))});o.find("#peakSpeedValue").on("change",function(e){m("PeakSpeed",e.target.value)});var h=e('<div id="sliderContainer" class="row"></div>');i.append(h);var T=e('<div class="col-sm-3 title"><span id="rmsTorqueTitle">RMS Torque: </sapn></div>');h.append(T);var x=e('<div class="col-sm-4"><input id="rmsTorqueSlider" data-slider-value="'+d.rmsPoints[1]+'" data-slider-id="sizeSlider" type="text" data-slider-tooltip="hide"/></div>');h.append(x);var q=e('<div class="col-sm-5"><input type="number" id="rmsTorqueValue" name="quantity" min="0" max="'+d.sliderLimit.rmsMaxTorque+'" value="'+d.rmsPoints[1]+'" class="widgetNumberInput form-control bfh-number"><lable class="value">&nbsp;&nbsp;Nm</label></div>');h.append(q);x.find("#rmsTorqueSlider").slider({min:0,max:d.sliderLimit.rmsMaxTorque,step:.1}).on("change",function(){return x.find("#rmsTorqueSlider").slider("getValue")>d.peakPoints[1]?(x.find("#rmsTorqueSlider").slider("setValue",d.peakPoints[1]),V("RMS Torque can not be greater than Peak Torque."),!1):(V(""),void v("RmsTorque"))});o.find("#rmsTorqueValue").on("change",function(e){m("RmsTorque",e.target.value)});var g=e('<div id="sliderContainer" class="row"></div>');i.append(g);var k=e('<div class="col-sm-3 title"><span id="rmsSpeedTitle">RMS Speed: </span></div>');g.append(k);var b=e('<div class="col-sm-4"><input id="rmsSpeedSlider" data-slider-value="'+d.rmsPoints[0]+'" data-slider-id="sizeSlider" type="text" data-slider-tooltip="hide"/></div>');g.append(b);var P=e('<div class="col-sm-5"><input type="number" id="rmsSpeedValue" name="quantity" min="0" max="'+d.sliderLimit.rmsMaxSpeed+'" value="'+d.rmsPoints[0]+'" class="widgetNumberInput form-control bfh-number"><lable class="value">&nbsp;&nbsp;rad/sec</label></div>');g.append(P);b.find("#rmsSpeedSlider").slider({min:0,max:d.sliderLimit.rmsMaxSpeed,step:1}).on("change",function(){return b.find("#rmsSpeedSlider").slider("getValue")>d.peakPoints[0]?(b.find("#rmsSpeedSlider").slider("setValue",d.peakPoints[0]),void V("RMS Speed can not be greater than Peak Speed.")):(V(""),void v("RmsSpeed"))});if(o.find("#rmsSpeedValue").on("change",function(e){m("RmsSpeed",e.target.value)}),d.showMotorTsCurve){var C=e('<div id="sliderContainer" class="row"></div>');i.append(C)}i.append('<div id="alertMessageContainer" class="alert alert-warning"><strong>Warning:-&nbsp;&nbsp;</strong><span></span></div>');var V=function(e){return""===e?void i.find("#alertMessageContainer").hide():(i.find("#alertMessageContainer").show(),void i.find("#alertMessageContainer span").text(e))}},S=function(a){var t=e('<div class="panel panel-default"></div>');a.append(t);var o=e('<div class="panel-heading" role="tab" id="headingThree"> <h4 class="panel-title"> <a role="button"  data-parent="#accordion'+d.uniqeId+'" data-toggle="collapse"  href="#collapseThree'+d.uniqeId+'" aria-controls="collapseThree" aria-expanded="false"><span> Environmental Factors</span> <span class="accordion-plus-minus glyphicon pull-right glyphicon-chevron-down fa fa-chevron-down" aria-hidden="true" style="color: grey;"></span> </a> </h4> </div>');t.append(o);var i=e('<div id="collapseThree'+d.uniqeId+'" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree"></div>');t.append(i);var l=e('<div class="panel-body"></div>');i.append(l),t.on("show.bs.collapse",function(a){e(this).find(".accordion-plus-minus").removeClass("glyphicon-chevron-down fa fa-chevron-down").addClass("glyphicon-chevron-up fa fa-chevron-up")}),t.on("hide.bs.collapse",function(a){e(this).find(".accordion-plus-minus").removeClass("glyphicon-chevron-up fa fa-chevron-up").addClass("glyphicon-chevron-down fa fa-chevron-down")}),h(l)},h=function(a){var l=e('<div id="envFactorsPanelContainer"></div>');a.append(l);var r=e('<div id="sliderContainer" class="row"></div>');l.append(r);var n=e('<div class="col-sm-3 title"><span id="tempTitle">Temperature: </span></div>');r.append(n);var s=e('<div class="col-sm-4"><input id="tempSlider" data-slider-id="sizeSlider" type="text" data-slider-tooltip="hide"/></div>');r.append(s);var u=e('<div class="col-sm-5"><input type="number" id="tempValue" name="quantity" min="0" value="'+d.motorData[d.motorSelectedIndex].temp+'" class="widgetNumberInput form-control bfh-number"><lable class="value">&nbsp;&deg;C</label></div>');r.append(u);var c=d.sliderLimit.maxTemp||i.sliderLimit.maxTemp;d.defaultPeakStallTorque=d.motorData[d.motorSelectedIndex].peakStallTorque,d.defaultRollOffPoint=d.motorData[d.motorSelectedIndex].rollOffPoint,d.defaultRollOffSpeed=d.motorData[d.motorSelectedIndex].rollOffSpeed,d.defaultPeakTorqueAtMaxSpeed=d.motorData[d.motorSelectedIndex].peakTorqueAtMaxSpeed,d.defaultContinuousStallTorque=d.motorData[d.motorSelectedIndex].continuousStallTorque,d.defaultContinuosTorqueAtMaxSpeed=d.motorData[d.motorSelectedIndex].continuosTorqueAtMaxSpeed,r.find("#tempSlider").slider({value:d.motorData[d.motorSelectedIndex].temp,min:0,max:c,step:1}).on("change",function(e){o.find("#tempValue").val(e.value.newValue);var a=e.value.newValue-e.value.oldValue;0!==a&&(m("peakPlot",e.value.newValue),m("rmsPlot",e.value.newValue))}),o.find("#tempValue").on("change",function(e){o.find("#tempSlider").slider("setValue",parseInt(e.target.value)),m("peakPlot",parseInt(e.target.value)),m("rmsPlot",parseInt(e.target.value))});var m=function(e,a){var o=t.getData(),i=a,l=40,r=155,n=25,s=i+.6*(r-i),u=l+.6*(r-l),c=-.0015,m=1-(i-l)/(r-l),v=(n+234.5)/(u+234.5),f=1+(s-u)*c;switch(e){case"peakPlot":for(var S=o[0].data,h=0;h<S.length;h++)void 0!=d.motorData[d.motorSelectedIndex]&&(0!=h&&12!=h&&6!=h||(S[h][1]=d.defaultPeakStallTorque*f,0==h&&(d.motorData[d.motorSelectedIndex].peakStallTorque=S[h][1]),6==h&&(S[h][1]=-S[h][1])),1!=h&&7!=h||(S[h][1]=d.defaultRollOffPoint*f,S[h][0]=d.defaultRollOffSpeed/f,d.motorData[d.motorSelectedIndex].rollOffPoint=S[h][1],d.motorData[d.motorSelectedIndex].rollOffSpeed=S[h][0],7==h&&(S[h][0]=-S[h][0],S[h][1]=-S[h][1])),2!=h&&8!=h||(S[h][1]=d.defaultPeakTorqueAtMaxSpeed*f,d.motorData[d.motorSelectedIndex].peakTorqueAtMaxSpeed=S[h][1],8==h&&(S[h][1]=-S[h][1])));o[0].data=S;break;case"rmsPlot":for(var T=o[2].data,h=0;h<T.length;h++)void 0!=d.motorData[d.motorSelectedIndex]&&(0!=h&&10!=h&&5!=h||(T[h][1]=d.defaultContinuousStallTorque*(f*Math.sqrt(m/v)),d.motorData[d.motorSelectedIndex].continuousStallTorque=T[h][1],5==h&&(T[h][1]=-T[h][1])),1!=h&&6!=h||(T[h][1]=d.defaultContinuosTorqueAtMaxSpeed*(f*Math.sqrt(m/v)),d.motorData[d.motorSelectedIndex].continuosTorqueAtMaxSpeed=T[h][1],6==h&&(T[h][1]=-T[h][1])));o[2].data=T}y(o),p()},v=e('<div id="sliderContainer" class="row"></div>');l.append(v);var f=e('<div class="col-sm-3 title"><span id="altitudeTitle">Altitude: </span></div>');v.append(f);var S=e('<div class="col-sm-4"><input id="altitudeSlider" data-slider-id="sizeSlider" type="text" data-slider-tooltip="hide"/></div>');v.append(S);var h=e('<div class="col-sm-5"><input type="number" id="altitudeValue" name="quantity" min="0" value="'+d.motorData[d.motorSelectedIndex].altitude+'" class="widgetNumberInput form-control bfh-number"><label class="value">&nbsp;&nbsp;m</label></div>');v.append(h);var c=d.sliderLimit.maxAltitude||i.sliderLimit.maxAltitude;d.defaultContinuousStallTorque=d.motorData[d.motorSelectedIndex].continuousStallTorque,d.defaultContinuosTorqueAtMaxSpeed=d.motorData[d.motorSelectedIndex].continuosTorqueAtMaxSpeed,S.find("#altitudeSlider").slider({value:d.motorData[d.motorSelectedIndex].altitude,min:0,max:1e4,step:1}).on("change",function(e){o.find("#altitudeValue").val(e.value.newValue);var a=t.getData(),i=a[2].data;if(e.value.newValue>1500){var l=[1-(e.value.newValue-1500)/1e4];i[0][1]=i[10][1]=(d.defaultContinuousStallTorque*l).toFixed(3),i[1][1]=(d.defaultContinuosTorqueAtMaxSpeed*l).toFixed(3),a[2].data=i,d.motorData[d.motorSelectedIndex].continuousStallTorque=i[0][1],d.motorData[d.motorSelectedIndex].continuosTorqueAtMaxSpeed=i[1][1]}else{var l=1;i[0][1]=i[10][1]=(d.defaultContinuousStallTorque*l).toFixed(3),i[1][1]=(d.defaultContinuosTorqueAtMaxSpeed*l).toFixed(3),a[2].data=i,d.motorData[d.motorSelectedIndex].continuousStallTorque=i[0][1],d.motorData[d.motorSelectedIndex].continuosTorqueAtMaxSpeed=i[1][1]}y(a),p()}),o.find("#altitudeValue").on("change",function(e){var a=parseInt(e.target.value),i=t.getData(),l=i[2].data;if(o.find("#altitudeSlider").slider("setValue",a),a>1500){var r=[1-(a-1500)/1e4];l[0][1]=l[10][1]=(d.defaultContinuousStallTorque*r).toFixed(3),l[1][1]=(d.defaultContinuosTorqueAtMaxSpeed*r).toFixed(3),i[2].data=l,d.motorData[d.motorSelectedIndex].continuousStallTorque=l[0][1],d.motorData[d.motorSelectedIndex].continuosTorqueAtMaxSpeed=l[1][1]}else{var r=1;l[0][1]=l[10][1]=(d.defaultContinuousStallTorque*r).toFixed(3),l[1][1]=(d.defaultContinuosTorqueAtMaxSpeed*r).toFixed(3),i[2].data=l,d.motorData[d.motorSelectedIndex].continuousStallTorque=l[0][1],d.motorData[d.motorSelectedIndex].continuosTorqueAtMaxSpeed=l[1][1]}y(i),p()})},T=function(a){var t=e('<div class="panel panel-default"></div>');a.append(t);var o=e('<div class="panel-heading" role="tab" id="headingFour"> <h4 class="panel-title"> <a role="button"   data-parent="#accordion'+d.uniqeId+'"  data-toggle="collapse"  href="#collapseFour'+d.uniqeId+'" aria-controls="collapseFour" aria-expanded="false"><span> Transmission Ratio</span> <span class="accordion-plus-minus glyphicon pull-right glyphicon-chevron-down fa fa-chevron-down" aria-hidden="true" style="color: grey;"></span> </a> </h4> </div>');t.append(o);var i=e('<div id="collapseFour'+d.uniqeId+'" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingFour"></div>');t.append(i);var l=e('<div class="panel-body"></div>');i.append(l),t.on("show.bs.collapse",function(a){e(this).find(".accordion-plus-minus").removeClass("glyphicon-chevron-down fa fa-chevron-down").addClass("glyphicon-chevron-up fa fa-chevron-up")}),t.on("hide.bs.collapse",function(a){e(this).find(".accordion-plus-minus").removeClass("glyphicon-chevron-up fa fa-chevron-up").addClass("glyphicon-chevron-down fa fa-chevron-down")}),x(l)},x=function(a){var t=e('<div id="transmissionRatioPanelContainer"></div>');a.append(t);var l=e('<div id="sliderContainer" class="row"></div>');t.append(l);var r=e('<div class="col-sm-3 title"><span id="trRatioTitle">Transmission Ratio: </span></div>');l.append(r);var n=e('<div class="col-sm-4" ><input id="trRatioSlider" data-slider-id="sizeSlider" type="text" data-slider-tooltip="hide"/></div>');l.append(n);var s=e('<div class="col-sm-5"><input type="number" id="trRatioValue" name="quantity" min="1" max="'+d.sliderLimit.maxTrRatio+'" value="1" class="widgetNumberInput form-control bfh-number"><lable class="value">&nbsp;: 1</label></div>');l.append(s),d.defaultRmsTorque=d.rmsPoints[1],d.defaultRmsSpeed=d.rmsPoints[0],d.defaultPeakTorque=d.peakPoints[1],d.defaultPeakSpeed=d.peakPoints[0],n.find("#trRatioSlider").slider({min:1,value:1,max:d.sliderLimit.maxTrRatio||i.sliderLimit.maxTrRatio,step:1}).on("change",function(){v("TransmissionRatio")}),o.find("#trRatioValue").on("change",function(e){m("TransmissionRatio",e.target.value)})},q=function(a){var t=e('<div class="tsPlotContainer"></div>');a.append(t);var o=e('<div class="tsPlotArea"></div>');t.append(o);var i=e('<div class="curveConfigContainer row"></div>');a.append(i),d.showQuadrantToggle&&g(i),P()},g=function(a){var t=e('<div class="plotModeContainer"> <label id="quadrantTitle">Quadrant: &nbsp;&nbsp;&nbsp;</label> <div class="btn-group" id="plotModeToggle"> <button id="1quad" value="1" class="btn btn-default">Single</button> <button id="4quad" value="4" class="btn btn-default">Four</button> </div></div>');d.quadrant&&t.find("#"+d.quadrant+"quad").addClass("selectedQuad"),a.append(t),t.find("#plotModeToggle .btn").click(function(){e(this).hasClass("selectedQuad")||(t.find(".selectedQuad").removeClass("selectedQuad"),e(this).addClass("selectedQuad"),d.quadrant=parseInt(e(this).val()),P())})},k=function(a){var t=o.find(".tsCruveContainer"),i=e('<div id="servoMotorInfoContainer" class="tsModal"></div>');t.append(i);var l=e('<div class="motorSpecTable"></div>');b(d.motorSelectedIndex,l),i.append(l)},b=function(a){var t=o.find("#servoMotorInfoContainer").find(".motorSpecTable"),i=t.find("table");i.length>0&&i.remove();var i=e('<table class="table table-striped"></table>'),l=e('<caption class="motorTableTitle">Motor Specifications - '+d.motorData[a].motorPartNo+'<div class="closeButtonStyle">X</div></caption>'),r=e('<thead><tr><th class="leftCol tableTitle">Parameters</th><th class="rightCol tableTitle">Value</th></tr></thead>'),n=e("<tbody></tbody>");t.append(i),i.append(l),i.append(r),i.append(n),n.append('<tr> <td class="leftCol"> Frame Size </td><td class="rightCol">'+d.motorData[a].FrameSize+"</td></tr>"),n.append('<tr> <td class="leftCol"> Peak Stall Torque </td><td class="rightCol">'+d.motorData[a].peakStallTorque+" N-m</td></tr>"),n.append('<tr> <td class="leftCol"> Roll Off Point </td><td class="rightCol">'+d.motorData[a].rollOffPoint+" N-m</td></tr>"),n.append('<tr> <td class="leftCol"> Roll Off Speed </td><td class="rightCol">'+d.motorData[a].rollOffSpeed+" rad/sec</td></tr>"),n.append('<tr> <td class="leftCol"> Max Speed </td><td class="rightCol">'+d.motorData[a].maxSpeed+" rad/sec</td></tr>"),n.append('<tr> <td class="leftCol"> Peak Torque at Max Speed </td><td class="rightCol">'+d.motorData[a].peakTorqueAtMaxSpeed+" N-m</td></tr>"),n.append('<tr> <td class="leftCol"> Continuous Stall Torque </td><td class="rightCol">'+d.motorData[a].continuousStallTorque+" N-m</td></tr>"),n.append('<tr> <td class="leftCol"> Continuos Torque at Max Speed </td><td class="rightCol">'+d.motorData[a].continuosTorqueAtMaxSpeed+" N-m</td></tr>")},P=function(){var e=[],a={colors:[d.graphLineColor.peakTSCurve,d.graphLineColor.peakTSCurve,d.graphLineColor.contionusTSCurve,d.graphLineColor.contionusTSCurve],series:{points:{show:!0}},legend:{backgroundOpacity:0},coordinate:{type:"rectangular"},axisLabels:{show:!0},xaxis:{axisLabel:"Speed (rad/sec)"},yaxis:{axisLabel:"Torque (N-m)"},grid:{hoverable:!0,clickable:!0,borderWidth:1,borderColor:"#D9D9D9",margin:0,markings:[{yaxis:{from:0,to:0},color:"#333"},{xaxis:{from:0,to:0},color:"#333"}]},tooltip:!0,tooltipOpts:{cssClass:"tsCurveFlotTip",content:function(e,a,t,o){var i="";switch(o.seriesIndex){case 0:switch(o.dataIndex){case 0:i="Peak Stall Torque <br />";break;case 1:i="Roll Off Point<br />";break;case 2:i="Peak Torque at Max Speed <br />";break;case 3:i="Max Speed at Zero Torque <br />"}break;case 1:i="Peak T/S Point <br />";break;case 2:switch(o.dataIndex){case 0:i="Continuous Stall Torque <br />";break;case 1:i="Continuous Stall Torque at Max Speed <br />";break;case 2:i="Max Speed Point <br />"}break;case 3:i="RMS T/S Point <br />"}return i+"Speed: "+a+", Torque: "+t},defaultTheme:!1,shifts:{x:0,y:20}}};1==d.quadrant&&(a.xaxis.min=0,a.yaxis.min=0);var o=[],i=[],l=[],r=[],n=[],s=[],u=[],p=[],c=function(){o=[],i=[],l=[],r=[],n=[],s=[],u=[],p=[]},m=function(e){var a=e.maxSpeed;n=[[0,e.peakStallTorque],[e.rollOffSpeed,e.rollOffPoint],[a,e.peakTorqueAtMaxSpeed],[a,0]],u=[[0,e.continuousStallTorque],[a,e.continuosTorqueAtMaxSpeed],[a,0]]},v=function(e){var a=-1*e.maxSpeed;s=[[a,0],[a+1,e.peakStallTorque]],p=[[a,0],[a+1,e.continuousStallTorque]]},f=function(e){o=o.concat(n),i=i.concat(u)},S=function(e){var a=[],t=[];s.length>0&&s.forEach(function(e,t,o){var i=[];i[0]=-1*e[0],i[1]=-1*e[1],a[t]=i}),o=o.concat(a),p.length>0&&p.forEach(function(e,a,o){var i=[];i[0]=-1*e[0],i[1]=-1*e[1],t[a]=i}),i=i.concat(t)},h=function(e){var a=[],t=[];n.length>0&&n.forEach(function(e,t,o){var i=[];i[0]=-1*e[0],i[1]=-1*e[1],a[t]=i}),o=o.concat(a),u.length>0&&u.forEach(function(e,a,o){var i=[];i[0]=-1*e[0],i[1]=-1*e[1],t[a]=i}),i=i.concat(t)},T=function(e){o=o.concat(s),i=i.concat(p)},x=function(e){o.push([0,e.peakStallTorque]),i.push([0,e.continuousStallTorque])},q=function(e){var a=e.temp,t=40,o=155,i=25,d=a+.6*(o-a),l=t+.6*(o-t),r=-.0015,n=1-(a-t)/(o-t),s=(i+234.5)/(l+234.5),u=1+(d-l)*r;return e.peakStallTorque=(e.peakStallTorque*u).toFixed(2),e.rollOffPoint=(e.rollOffPoint*u).toFixed(2),e.rollOffSpeed=(e.rollOffSpeed/u).toFixed(2),e.continuousStallTorque=(e.continuousStallTorque*(u*Math.sqrt(n/s))).toFixed(2),e.continuosTorqueAtMaxSpeed=(e.continuosTorqueAtMaxSpeed*(u*Math.sqrt(n/s))).toFixed(2),e},g=function(e){f(e),S(e),h(e),T(e),x(e)},k=function(e){c();var a=q(e);m(a),v(a),g(a)};d.showMotorTsCurve&&k(d.motorData[d.motorSelectedIndex]),d.showApplicationPoints&&(l.push(d.peakPoints),r.push(d.rmsPoints)),e.push({data:o,label:"Peak T-S Curve",lines:{lineWidth:2,show:!0}},{data:l,label:"",points:{show:!0,fillColor:d.graphLineColor.peakTSCurve,radius:4}},{data:i,label:"Continous T-S Curve",lines:{lineWidth:2,show:!0}},{data:r,label:"",points:{show:!0,fillColor:d.graphLineColor.contionusTSCurve,radius:4}}),t?y(e,a):M(e,a)},C=function(e){function a(e,a,t,o){var d=!1,l=(a[1]-e[1])/(a[0]-e[0]),r=e[1]-l*e[0],n=-1,s=l*t[0]-t[1]+r;if(d=0==s||s>0&&0>n||0>s&&n>0,o){var u=t[0]*t[1],v=t[0]*(l*t[0]+r),f=100*u/v;m.push(f)}else{var S=100*t[1]/(l*t[0]+r),h=100*t[0]/i.maxSpeed;p.push(S),c.push(h)}return d}function t(e){var a=100*e[1]/i.peakStallTorque,t=100*e[0]/i.maxSpeed;p.push(a),c.push(t)}function o(e){var a=e[0]*e[1],t=e[0]*i.continuousStallTorque,o=100*a/t;m.push(o)}var i=e,l=d.peakPoints,r=d.rmsPoints,n={PeakStallPoint:{x:0,y:i.peakStallTorque},RollOffPoint:{x:i.rollOffSpeed,y:i.rollOffPoint},PeakTarqueAtMaxSpeedPoint:{x:i.maxSpeed,y:i.peakTorqueAtMaxSpeed},ContinuousStallTorquePoint:{x:0,y:i.continuousStallTorque},ContinuousStallTorqueMaxSpeedPoint:{x:i.maxSpeed,y:i.continuosTorqueAtMaxSpeed}},s=0,u=null,p=[],c=[],m=[],v=null,f=null,S=null,h={status:u,torqueUtilization:v,speedUtilization:f,avgPower:S},T=r[0],x=r[1],q=l[0],g=l[1],k=!1,b=!1,P=null,C=null,V=null;return T<=i.maxSpeed?(P=[n.ContinuousStallTorquePoint.x,n.ContinuousStallTorquePoint.y],C=[n.ContinuousStallTorqueMaxSpeedPoint.x,n.ContinuousStallTorqueMaxSpeedPoint.y],V=[T,x],b=a(P,C,V,!0)):(s=-1,o([T,x])),g<=i.peakStallTorque&&q<=i.maxSpeed?q<=n.RollOffPoint.x?(P=[n.PeakStallPoint.x,n.PeakStallPoint.y],C=[n.RollOffPoint.x,n.RollOffPoint.y],V=[q,g],k=a(P,C,V,!1)):(P=[n.RollOffPoint.x,n.RollOffPoint.y],C=[n.PeakTarqueAtMaxSpeedPoint.x,n.PeakTarqueAtMaxSpeedPoint.y],V=[q,g],k=a(P,C,V,!1)):(s=-1,t([q,g])),-1!=s&&0!=k&&0!=b||(s=-1),-1==s?h.status=!1:0==s&&(h.status=!0),h.torqueUtilization=Math.max.apply(Math,p),h.speedUtilization=Math.max.apply(Math,c),h.avgPower=Math.max.apply(Math,m),h},V=function(){if(!d.showMotorTsCurve){var e=Math.max(d.peakPoints[0]+50,d.rmsPoints[0]+50,200),a=Math.max(d.peakPoints[1]+10,d.rmsPoints[1]+10,50);t.getOptions().yaxes[0].max=a,t.getOptions().xaxes[0].max=e,4===d.quadrant&&(t.getOptions().yaxes[0].min=-1*a,t.getOptions().xaxes[0].min=-1*e)}},w=function(){4==d.quadrant?(t.getOptions().grid.markings[0].color="#bdbdbd",t.getOptions().grid.markings[1].color="#bdbdbd"):(t.getOptions().grid.markings[0].color="#333",t.getOptions().grid.markings[1].color="#333"),V(),t.setupGrid(),t.draw()},M=function(a,i){setTimeout(function(){t=e.plot(o.find(".tsPlotArea"),a,i),
w()},0)},y=function(e,a){a&&(void 0!=a.xaxis.min&&void 0!=a.yaxis.min?(t.getOptions().yaxes[0].min=a.yaxis.min,t.getOptions().xaxes[0].min=a.xaxis.min):(t.getOptions().yaxes[0].min=null,t.getOptions().xaxes[0].min=null)),t.setData(e),w(),I()},I=function(){d.assessmentMode&&d.assessmentCallback&&d.assessmentCallback({peakTorque:{value:o.find("#peakTorqueValue").val(),unit:"Nm"},peakSpeed:{value:o.find("#peakSpeedValue").val(),unit:"rad/sec"},rmsTorque:{value:o.find("#rmsTorqueValue").val(),unit:"Nm"},rmsSpeed:{value:o.find("#rmsSpeedValue").val(),unit:"rad/sec"},temperature:{value:o.find("#tempValue").val(),unit:"C"},altitude:{value:o.find("#altitudeValue").val(),unit:"m"},transmissionRatio:{value:o.find("#trRatioValue").val(),unit:""},status:{value:C(d.motorData[d.motorSelectedIndex]).status,unit:""}})},D=function(e){e.peakTorque&&(o.find("#peakTorqueSlider").slider("setValue",e.peakTorque),o.find("#peakTorqueValue").val(e.peakTorque),v("PeakTorque")),e.peakSpeed&&(o.find("#peakSpeedSlider").slider("setValue",e.peakSpeed),o.find("#peakSpeedValue").val(e.peakSpeed),v("PeakSpeed")),e.rmsTorque&&(o.find("#rmsTorqueSlider").slider("setValue",e.rmsTorque),o.find("#rmsTorqueValue").val(e.rmsTorque),v("RmsTorque")),e.rmsSpeed&&(o.find("#rmsSpeedSlider").slider("setValue",e.rmsSpeed),o.find("#rmsSpeedValue").val(e.rmsSpeed),v("RmsSpeed")),e.temperature&&(o.find("#tempSlider").slider("setValue",e.temperature),o.find("#tempValue").val(e.temperature),v("Temperature")),e.altitude&&(o.find("#altitudeSlider").slider("setValue",e.altitude),o.find("#altitudeValue").val(e.altitude),v("Altitude")),e.transmissionRatio&&(o.find("#trRatioSlider").slider("setValue",e.transmissionRatio),o.find("#trRatioValue").val(e.transmissionRatio),v("TransmissionRatio"))},R=function(e){var a;e.peakTorque&&(a=e.peakTorque.status?"correct":"incorrect",o.find("#peakTorqueValue").addClass(a)),e.peakSpeed&&(a=e.peakSpeed.status?"correct":"incorrect",o.find("#peakSpeedValue").addClass(a)),e.rmsTorque&&(a=e.rmsTorque.status?"correct":"incorrect",o.find("#rmsTorqueValue").addClass(a)),e.rmsSpeed&&(a=e.rmsSpeed.status?"correct":"incorrect",o.find("#rmsSpeedValue").addClass(a)),e.temperature&&(a=e.temperature.status?"correct":"incorrect",o.find("#tempValue").addClass(a)),e.altitude&&(a=e.altitude.status?"correct":"incorrect",o.find("#altitudeValue").addClass(a)),e.transmissionRatio&&(a=e.transmissionRatio.status?"correct":"incorrect",o.find("#trRatioValue").addClass(a))};return l(),{ref:this,updateInputs:D,markAnswers:R}}}(jQuery);